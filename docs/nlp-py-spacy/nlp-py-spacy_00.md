## 序言

![Image](img/fm0xv.jpg)

越来越多的时候，当你拨打银行或互联网服务提供商的电话时，你可能会听到对方说：“你好，我是你的数字助手。请问有什么问题？”如今，机器人可以使用自然语言与人类对话，而且它们变得越来越聪明。尽管如此，仍然很少有人理解这些机器人是如何工作的，或者他们如何在自己的项目中使用这些技术。

自然语言处理（NLP）——一种帮助机器理解和响应人类语言的人工智能分支——是任何数字助手产品核心技术的关键。本书将为你提供开始创建自己的 NLP 应用所需的技能。在本书的最后，你将学会如何将 NLP 方法应用于现实问题，比如分析句子、捕捉文本的含义、创作原创文本，甚至构建自己的聊天机器人。

### **使用 Python 进行自然语言处理**

如果你想开发一个 NLP 应用程序，你可以从各种工具和技术中进行选择。本书中的所有示例都使用 Python 代码实现，且使用了 Python 的 spaCy NLP 库。以下是一些你可能想选择 Python 和 spaCy 进行 NLP 开发的有力理由。

Python 是一种高级编程语言，具有以下特点：

**简洁性** 如果你是编程新手，Python 是一个很好的入门语言，因为它非常易学。由于其简洁性，Python 允许你编写别人也能轻松理解的代码。例如，Python 的简洁性帮助聊天机器人开发者与那些没有太多编程经验的语言学家协作。

**普及性** Python 是最受欢迎的编程语言之一。绝大多数常用的 API 都有 Python 包装器，你可以通过 `pip` 安装工具轻松安装。通过 `pip` 安装 Python 包装器的能力简化了获取你可能希望在 NLP 应用中使用的第三方工具的过程。

**在 AI 生态系统中的重要地位** AI 生态系统中有很多 Python 库可供使用。这些库的可用性简化了你开发 NLP 应用程序的过程，使你可以在众多库中选择最适合解决特定任务的工具。

### **spaCy 库**

本书使用 spaCy，这是一个流行的 Python 库，包含了处理自然语言文本所需的语言数据和算法。正如你将在本书中学到的，spaCy 易于使用，因为它提供了表示自然语言文本元素的容器对象，例如句子和单词。这些对象又具有表示语言学特征的属性，如词性。写作时，spaCy 提供了针对英语、德语、希腊语、西班牙语、法语、意大利语、立陶宛语、挪威博克 mål 语、荷兰语、葡萄牙语以及多种语言的预训练模型。此外，spaCy 提供了内置的可视化工具，你可以通过编程调用它们来生成句子的句法结构或文档中的命名实体的图形。

spaCy 库还原生支持一些其他流行的 Python NLP 库不具备的高级 NLP 特性。例如，spaCy 原生支持词向量（在第五章中将详细讨论），而自然语言工具包（NLTK）则不支持。在使用后者时，你需要使用像 Gensim 这样的第三方工具，它是 word2vec 算法的 Python 实现。

使用 spaCy，你可以定制现有的模型或单独的模型组件，并且你可以从头开始训练自己的模型，以满足应用程序的需求（你将在第十章学习如何做到这一点）。你还可以连接由其他流行的*机器学习（ML）*库训练的统计模型，例如 TensorFlow、Keras、scikit-learn 和 PyTorch。此外，spaCy 可以与 Python 的 AI 生态系统中的其他库无缝协作，允许你例如在聊天机器人应用中利用计算机视觉，正如你将在第十二章中所做的那样。

### **谁应该阅读本书？**

本书适合那些有兴趣学习如何在实践中使用 NLP 的人。特别是，对于那些希望为企业或仅仅为了娱乐开发聊天机器人的人来说，这本书可能会很有趣。不论你是否具备 NLP 或编程的背景或经验，你都可以跟随本书提供的代码示例，因为这些示例都包含了详细的过程解释。

对 Python 有一定的基础知识将有所帮助，因为本书并不涉及 Python 语法的基础知识。此外，示例假设你具有初中级的英语语法和句法理解。附录是一些不太为人所知的语言学概念的参考。如果你对 NLP 概念有较好的理解并且具备基本的编程知识，示例将更容易理解。

### **本书内容概览**

*《Python 和 spaCy 的自然语言处理》* 开始时简要介绍了用于处理和分析自然语言数据的 NLP 技术的基本元素和方法。接着，书中会介绍越来越复杂的技术，帮助你应对自然语言给计算机处理和分析带来的挑战。每章的“尝试一下”部分将帮助你巩固刚学到的内容。

以下是你将在每章中找到的内容：

**第一章: 自然语言处理原理** 简要介绍了自然语言处理（NLP）技术的基本元素。它描述了生成 NLP 库数据的机器学习技术，如 spaCy，包括用于解决 NLP 问题的统计语言建模和统计神经网络模型。然后，它讲解了 NLP 应用开发人员面临的任务和挑战。

**第二章: 文本处理管道** 解释了 spaCy 是什么，它的设计目的是什么，然后展示了如何快速入门。它涵盖了设置工作环境的步骤，并通过使用文本处理管道进行编码，管道是一系列基本的 NLP 操作，用于确定话语的含义和意图。

**第三章: 使用容器对象与自定义 spaCy** 介绍了 spaCy 的架构，重点讲解了库中可用的核心数据结构。你将通过跟随示例，亲自体验 spaCy 的关键对象。你还将学习如何自定义管道组件，以满足你应用的需求。

**第四章: 提取和使用语言特征** 说明了如何提取语言特征，如依赖关系标签、词性标注和命名实体。你将学习如何生成并遍历句子的依赖树，探索句法关系。通过这些操作，你将学习如何以编程方式与聊天机器人用户继续对话、简化长文本并完成其他有用的任务。

**第五章: 使用词向量** 解释了 spaCy 的模型如何将自然语言单词映射到实数向量，从而允许你用词语进行数学运算。你将学习如何使用 spaCy 的相似度方法，通过比较容器对象的词向量来确定它们意义的相似度。

**第六章: 查找模式和遍历依赖树** 深入探讨了意义提取、句法依赖分析、名词短语切分和实体识别的细节。你将完成从原始文本中提取意义所需的所有步骤，使用词序列模式和遍历依赖树。本章介绍了 spaCy 的 Matcher 工具来查找模式，并讨论了在何种情况下你仍然需要依赖上下文来确定正确的处理方法。

**第七章: 可视化** 讨论了如何利用 spaCy 内置的 displaCy 可视化工具，你可以用它来可视化浏览器中的句法依赖关系和命名实体。可视化有助于你立即识别数据中的模式。

**第八章: 意图识别** 演示了意图提取，这是聊天机器人开发中的一个常见任务。你将学习如何从文本数据中提取意义，这通常是一个具有挑战性的任务，但在 Python 中只需几行代码即可完成。

**第九章: 将用户输入存储到数据库中** 教你如何自动从用户输入中提取关键词并将其存储到关系型数据库中，然后你可以使用这些关键词填写订单表单或其他业务文档。

**第十章: 训练模型** 介绍了如何训练 spaCy 的命名实体识别器和依赖分析器，以满足你的应用程序中 spaCy 默认模型无法覆盖的需求。它详细讲解了如何用新示例训练一个现有的预训练模型，以及如何从头开始训练一个空白模型。

**第十一章: 部署你的聊天机器人** 引导你完成将聊天机器人应用部署到 Telegram——一个流行的即时通讯服务——的过程，这样它就可以通过互联网与用户互动。

**第十二章: 实现网页数据和图像处理** 展示了如何让你的聊天机器人使用 spaCy 和其他 Python 人工智能生态系统中的库，从维基百科提取问题答案，并对用户提交的图像做出反应。

**附录: 语言学入门** 包含了一本简短的指南，讲解书中最常讨论的语法和句法元素。没有语言学背景的读者可以将其作为参考。
