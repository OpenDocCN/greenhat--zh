# 序言

> 银行本质上是科技公司。
> 
> ——Hugo Banziger，前德意志银行首席风险官

![](img/chapterart.png)

Python 目前是全球最受欢迎的编程语言，超越了 Java 和 C 等更为传统的编程语言。一旦你开始使用 Python 编程，就会很容易理解为什么它如此受欢迎。Python 的两个主要优势是简洁性和开放性。Python 代码相对接近普通英语，因此即使经验不多，你通常也能猜出一个脚本想要实现的功能。

Python 是开源的，这不仅意味着软件对每个人免费使用，还意味着其他用户可以创建和修改库。实际上，Python 拥有庞大的生态系统，用户可以从社区成员那里获得资源和帮助。Python 程序员可以相互分享代码，因此，你不必从头开始构建一切，可以导入他人设计的模块，并将自己的模块分享给 Python 社区的其他成员。

当人们听说我正在写一本关于语音识别和语音合成的 Python 书籍时，他们的反应通常是一样的：“我以为你是*金融*教授。”我的典型回答是本章开头引用的 Hugo Banziger 名言，这是在 2008 年金融危机后不久说的。如今，你可以将*银行*替换成任何行业的公司——汽车制造商、零售商，几乎任何行业——这句话依然适用。如今，技术渗透到了我们生活的方方面面。未来已经到来，且就在眼前。

自 2018 年以来，Python 一直是全球最受欢迎的编程语言。在此之前，Python 在金融领域一直是领先的编程语言，广泛应用于金融服务、投资组合管理、算法交易、加密货币等方面。

在与我金融学硕士（MSF）学生的潜在雇主交流时，我被告知他们有懂金融的人，但不懂编程——也有懂编程的人，但对金融一无所知。他们希望招聘那些既懂金融又懂编程的人。因此，我们开始将 Python 纳入 MSF 课程。

金融学学生的反应各不相同。许多学生发现 Python 既易用又多功能，而另一些学生则不明白，既然可以在微软 Excel 中完成所有工作，为什么还需要学习 Python。所以我开始向他们展示 Python 中一些在 Excel 中无法实现的酷技能，比如通过语音命令获取实时股票价格、创建一个会说话的美国股市图表等。我想向他们展示，Python 可以做更多 Excel 做不到的事情，而且入门门槛不高，最重要的是，它很有趣！

在本书中，我专注于语音识别和文本到语音的功能，这些功能在有趣且真正有用的应用中得到了实现，比如语音翻译器、语音控制的在线广播、虚拟个人助手、语音控制的图形游戏等。我的目标是教授可以在现实生活中应用和适应的 Python 技能，同时让对 Python 持怀疑态度的学生对他们所做的事情保持兴趣。

## 本书简介

本书既是*也是*不是一本 Python 入门书。虽然本书并不打算作为 Python 基础的完整教程，但它足够简洁，完全的初学者也能跟得上。你将学习如何在你的计算机上安装 Python，并编写你的第一个脚本。你还将学习 Python 的基本规则，了解函数和模块的工作原理，以及每个 Python 用户都需要知道的各种数据类型。通过这些，你将能够完成大多数简单的 Python 任务。

同时，本书*不是*一本 Python 入门书。我会提供一个 Python 回顾，帮助你为后续章节做准备，但它不是一本全面的入门教程。有许多精彩的书籍涵盖了 Python 的所有基础知识。其中一个例子是 Eric Matthes 的《*Python Crash Course*》（No Starch Press, 2019）。

除了回顾基础知识，本书的目的是提高你的技能，构建你可以在日常生活中使用的真实工作应用程序。本书还会让你逐渐过渡到更高级的主题，例如如何创建你自己的 Python 模块和包。在第三章，你将学习如何使用自定义模块中的函数来包含所有语音识别功能和相关代码，这样你就不需要每次将语音转换为文本时都重复编写代码。在第五章，你将创建一个包，你可以从中导入模块中的函数，在所有需要此功能的章节中将语音转换为文本（这几乎是本书剩余所有章节的内容）。在此过程中，你将学习 Python 模块和包的工作原理。

每章末的练习是一个很好的工具，可以帮助你练习概念并检查你是否真正理解它们。你将在书的最后找到答案。

本书中的代码是跨平台的，因此它应该可以在 Windows、Mac 或 Linux 系统中运行。每当有差异时，我会讨论三种操作系统之间的不同之处。

## 本书内容

本书分为四个部分。第一部分讨论如何安装 Python，以及你在后续章节中需要掌握的基本 Python 规则和技能。第二部分介绍语音识别和文本到语音的功能，包括如何安装和微调所需的模块。你还将利用语音识别和文本到语音的功能创建一个虚拟个人助手。

第三部分涉及互动游戏。你将学习如何创建图形游戏，并为其添加语音合成和语音识别功能，使其能够说话并接受语音指令。在第四部分，我们将构建一些应用程序来跟踪金融市场，并了解如何让 Python 在主要世界语言中进行对话和聆听。本书的最后一章通过将互动游戏和语音翻译功能整合，构建我们的终极虚拟助手。以下是本书的概览：

**第一部分：入门**

**第一章：设置 Python、Anaconda 和 Spyder**

你将安装本书所需的 Python 软件，并开始运行 Python 脚本，即使你对编程一无所知。我们还将讨论 Python 中的基本操作。

**第二章：Python 基础回顾**

你将学习如何使用 Python 内置函数以及如何导入 Python 标准库中的模块。然后，你将了解函数和模块是如何工作的，并学习如何创建你自己的函数和模块。我将讨论如何在你的计算机上安装这些模块。最后，你将了解虚拟环境，它们的用途以及如何创建和激活它们。

Python 使用字符串、列表、字典和元组作为元素集合来完成某些任务。在这一章中，你将了解这四种集合类型，并看到它们的使用示例。

**第二部分：学习说话**

**第三章：语音识别**

你将安装与语音识别相关的 Python 模块，然后创建一个脚本，让 Python 识别你的语音并将其打印出来。你将使用语音控制来完成几项任务，比如语音听写、打开网页浏览器、打开文件以及在计算机上播放音乐。为了节省脚本空间，你将学习如何将所有与语音识别相关的代码放入自定义的本地模块中，这样最终的脚本既简洁又清晰。

**第四章：让 Python 说话**

在这一部分，你将学习如何让 Python 用人的声音回应你。你将安装语音合成模块，并教会 Python 朗读你在 Spyder 中输入的任何内容。我们还将添加语音识别功能，让 Python 重复你所说的内容。所有与语音合成功能相关的代码都将存储在另一个自定义模块中。

**第五章：语音应用**

你将把第三章和第四章中的语音识别和语音合成功能应用到几个实际项目中。首先，你将解析文本，从国家公共广播电台（NPR）提取新闻摘要，并让 Python 朗读出来。你还将构建一个脚本，根据你的语音查询从维基百科提取信息并读出答案。最后，你将学习如何通过语音遍历文件夹中的文件，目标是打造你自己的 Alexa。你可以说：“Python，播放 Selena Gomez 的歌曲”，然后一首保存在你计算机上的 Selena Gomez 的歌曲就会播放。

**第六章：网页抓取播客、广播和视频**

你将学习网页抓取的基础知识。我将介绍超文本标记语言（HTML）如何构建网页。你将解析 HTML 文件并提取信息。然后，你将利用这些技能通过语音激活播客、直播电台和各种网站上的视频。

**第七章：构建虚拟个人助理**

你将创建自己的虚拟个人助理（VPA），类似于亚马逊的 Alexa。每当你需要帮助时，只需说“Hello, Python”唤醒你的 VPA；你还可以使用语音命令将其置于待机模式。VPA 可以作为计时器和闹钟，讲笑话，并且完全免提地发送电子邮件。

**第八章：全能 VPA**

在这里，你将为你的虚拟个人助理（VPA）添加全能功能。具体来说，你将利用计算引擎 WolframAlpha 的广泛知识库，如果 WolframAlpha 无法回答你的问题，还会使用 Wikipedia 作为备用。你的全能 VPA 能够为你回答几乎任何问题。

**第三部分：互动游戏**

**第九章：使用 Turtle 模块进行图形与动画**

我们在第三部分的目标是构建语音控制的图形化游戏，如井字游戏、四子棋和猜词游戏。你将全部在 *turtle* 模块中完成。在这一章中，你将学习基本的 *turtle* 命令，这些命令可以让你设置海龟屏幕、绘制形状并创建动画。

**第十章：井字游戏**

你将构建一个语音控制的井字游戏，将迄今为止学到的所有新技能付诸实践。你将绘制游戏棋盘，检查有效的移动，并检测玩家是否获胜。然后，你将添加语音识别和文本转语音功能，并设置游戏，使你可以与自己的计算机对战。

**第十一章：四子棋**

接下来，你将构建一个语音控制的四子棋游戏。你将绘制棋盘，动画化棋子从列的顶部落入最低可用单元格的效果，并使用 Python 逻辑强制执行一套新的游戏规则。然后，你将为游戏添加语音功能。

**第十二章：猜词游戏**

你将构建一个语音控制的图形化猜词游戏，这个游戏是流行的猜单词游戏的改编版。这是一个有趣的挑战，因为在玩猜词游戏时，玩家通常会快速地口头交换信息，因此你需要微调脚本的听力功能。

**第十三章：智能游戏：加入智能**

在井字棋或四连棋的一人模式中，计算机总是随机选择一个动作。在这一章中，我们将使用两种技术来构建智能游戏，让你思考如何在编程中分解和解决问题。第一种方法是“提前三步思考”的方法，计算机会按照最有可能在三步后获得胜利的路径走。第二种方法则是使用机器学习。你将模拟一百万场游戏，其中两位玩家都随机选择动作。通过这些数据，计算机将逐步学习并选择最有可能导致胜利的动作。

**第四部分：深入探索**

**第十四章：金融应用**

这些编程技能、语音识别和文本转语音技术可以应用到你生活中的任何方面。在这里，我将向你展示如何将这些技能应用于监控金融市场。然后，你就可以将这些技术推广到你感兴趣的任何领域。你将构建三个项目：一个可以告诉你任何上市公司最新股价的应用；一个构建股价可视化图表的脚本；以及一个使用最近每日股价计算回报、进行回归分析和详细分析的应用。

**第十五章：股市观察**

你将创建一个图形化、语音化的应用，实时监控美国股市，并在所选股票超过某个预设阈值时，用语音更新你。为了掌握所需的技能，你将首先使用*tkinter*创建一个图形化的比特币监控应用，以显示实时价格信息。

**第十六章：使用世界语言**

到目前为止，我们已经教会了 Python 如何用英语说话和听话。但 Python 还能理解许多其他世界语言。在这一章中，你将首先教 Python 用你已经在使用的模块说几种其他语言。然后，我将介绍一个叫做*translate*的有用模块，它可以将一种语言翻译成另一种语言。你将用它来构建一个翻译器，把你说的话翻译成你选择的其他语言。

**第十七章：终极虚拟个人助手**

你将为你的虚拟个人助手加载本书中的有趣项目，如语音控制游戏、翻译器、音乐播放器等。你将首先为 VPA 添加一个聊天功能，以便与脚本进行日常对话。虚拟个人助手的核心理念是其便捷性，因此我们将调整这些项目，使所有新增功能都能实现百分百的免提操作。

**附录 A：安装播放音频文件的模块**

由于本书的重点是让 Python 能够听与说，因此播放音频文件非常重要。本附录介绍了几个可以用来播放音频文件的模块，以及它们的优缺点。

**附录 B：章节末练习答案**

本附录提供了章节末所有习题的建议答案。你可以使用这些答案来检查自己的答案，并在遇到困难时寻求帮助。
